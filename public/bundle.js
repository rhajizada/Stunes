var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function r(){return Object.create(null)}function o(t){t.forEach(n)}function a(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e){t.appendChild(e)}function s(t,e,n){t.insertBefore(e,n||null)}function i(t){t.parentNode.removeChild(t)}function u(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function d(){return f(" ")}function p(){return f("")}function m(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function y(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function h(t,e){e=""+e,t.data!==e&&(t.data=e)}let $;function v(t){$=t}const g=[],k=[],b=[],w=[],x=Promise.resolve();let L=!1;function _(t){b.push(t)}function S(){const t=new Set;do{for(;g.length;){const t=g.shift();v(t),j(t.$$)}for(;k.length;)k.pop()();for(let e=0;e<b.length;e+=1){const n=b[e];t.has(n)||(n(),t.add(n))}b.length=0}while(g.length);for(;w.length;)w.pop()();L=!1}function j(t){t.fragment&&(t.update(t.dirty),o(t.before_update),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_update.forEach(_))}const O=new Set;let C;function E(){C={r:0,c:[],p:C}}function N(){C.r||o(C.c),C=C.p}function R(t,e){t&&t.i&&(O.delete(t),t.i(e))}function U(t,e,n,r){if(t&&t.o){if(O.has(t))return;O.add(t),C.c.push(()=>{O.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}function A(t,n){const r=n.token={};function o(t,o,a,l){if(n.token!==r)return;n.resolved=a&&{[a]:l};const c=e(e({},n.ctx),n.resolved),s=t&&(n.current=t)(c);n.block&&(n.blocks?n.blocks.forEach((t,e)=>{e!==o&&t&&(E(),U(t,1,1,()=>{n.blocks[e]=null}),N())}):n.block.d(1),s.c(),R(s,1),s.m(n.mount(),n.anchor),S()),n.block=s,n.blocks&&(n.blocks[o]=s)}if((a=t)&&"object"==typeof a&&"function"==typeof a.then){if(t.then(t=>{o(n.then,1,n.value,t)},t=>{o(n.catch,2,n.error,t)}),n.current!==n.pending)return o(n.pending,0),!0}else{if(n.current!==n.then)return o(n.then,1,n.value,t),!0;n.resolved={[n.value]:t}}var a}function T(t,e,r){const{fragment:l,on_mount:c,on_destroy:s,after_update:i}=t.$$;l.m(e,r),_(()=>{const e=c.map(n).filter(a);s?s.push(...e):o(e),t.$$.on_mount=[]}),i.forEach(_)}function q(t,e){t.$$.fragment&&(o(t.$$.on_destroy),t.$$.fragment.d(e),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={})}function B(t,e){t.$$.dirty||(g.push(t),L||(L=!0,x.then(S)),t.$$.dirty=r()),t.$$.dirty[e]=!0}function J(e,n,a,l,c,s){const i=$;v(e);const u=n.props||{},f=e.$$={fragment:null,ctx:null,props:s,update:t,not_equal:c,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(i?i.$$.context:[]),callbacks:r(),dirty:null};let d=!1;var p;f.ctx=a?a(e,u,(t,n)=>{f.ctx&&c(f.ctx[t],f.ctx[t]=n)&&(f.bound[t]&&f.bound[t](n),d&&B(e,t))}):u,f.update(),d=!0,o(f.before_update),f.fragment=l(f.ctx),n.target&&(n.hydrate?f.fragment.l((p=n.target,Array.from(p.childNodes))):f.fragment.c(),n.intro&&R(e.$$.fragment),T(e,n.target,n.anchor),S()),v(i)}class M{$destroy(){q(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function V(e){var n,r,o,a,l,p,m,h,$,v;return{c(){n=u("div"),(r=u("div")).textContent="Get ready to transfer your Spotify playlists to CSV files",o=d(),a=u("div"),(l=u("h5")).textContent="First login",p=d(),(m=u("p")).textContent="Login with your Spotify Account",h=d(),$=u("a"),v=f("Login"),y(r,"class","card-header"),y(l,"class","card-title"),y(m,"class","card-text"),y($,"href",H),y($,"class","btn btn-primary"),y(a,"class","card-body"),y(n,"class","card center bg-secondary svelte-15v4z7f")},m(t,e){s(t,n,e),c(n,r),c(n,o),c(n,a),c(a,l),c(a,p),c(a,m),c(a,h),c(a,$),c($,v)},p:t,i:t,o:t,d(t){t&&i(n)}}}let H="/login";class P extends M{constructor(t){super(),J(this,t,null,V,l,[])}}function z(e){var n,r,a,l,p,$,v,g,k,b,w,x,L,_,S,j,O,C=e.playlist.meta.name,E=e.playlist.meta.tracks.total;return{c(){n=u("div"),r=u("img"),p=d(),$=u("div"),v=u("h5"),g=f(C),k=d(),b=u("p"),w=f(E),x=f(" tracks"),L=d(),(_=u("button")).innerHTML='<i class="fa fa-arrow-down" aria-hidden="true"></i> CSV',S=d(),(j=u("button")).innerHTML='<i class="fa fa-arrow-down" aria-hidden="true"></i> JSON',y(r,"src",a=e.playlist.meta.images[0].url),y(r,"class","card-img-top svelte-10500pv"),y(r,"alt",l=e.playlist.meta.images[0].url),y(v,"class","card-title svelte-10500pv"),y(b,"class","card-text svelte-10500pv"),y(_,"type","button"),y(_,"class","btn btn-success"),y(j,"type","button"),y(j,"class","btn btn-success"),y($,"class","card-body svelte-10500pv"),y(n,"class","card svelte-10500pv"),O=[m(_,"click",e.downloadCSV),m(j,"click",e.downloadJSON)]},m(t,e){s(t,n,e),c(n,r),c(n,p),c(n,$),c($,v),c(v,g),c($,k),c($,b),c(b,w),c(b,x),c($,L),c($,_),c($,S),c($,j)},p(t,e){t.playlist&&a!==(a=e.playlist.meta.images[0].url)&&y(r,"src",a),t.playlist&&l!==(l=e.playlist.meta.images[0].url)&&y(r,"alt",l),t.playlist&&C!==(C=e.playlist.meta.name)&&h(g,C),t.playlist&&E!==(E=e.playlist.meta.tracks.total)&&h(w,E)},i:t,o:t,d(t){t&&i(n),o(O)}}}function F(t,e,n){let{playlist:r}=e;const o=(a=document.createElement("a"),document.body.appendChild(a),a.style="display: none",function(t,e){let n=new Blob([t],{type:"text/csv;charset=utf-8;"}),r=window.URL.createObjectURL(n);a.href=r,a.download=e,a.click(),window.URL.revokeObjectURL(r)});var a;const l=function(){var t=document.createElement("a");return document.body.appendChild(t),t.style="display: none",function(e,n){let r=new Blob([e],{type:"application/json"}),o=window.URL.createObjectURL(r);t.href=o,t.download=n,t.click(),window.URL.revokeObjectURL(o)}}(),c=()=>{let t="Title; Artist; Album\n";for(let e of r.tracklist){let n=e.track.name,r=e.track.album.name,o=[];for(let t of e.track.artists)o.push(t.name);t+=`${n}; ${o.join(", ")}; ${r}\n`}return t},s=()=>{let t={playlist_name:r.meta.name,playlist_image:r.meta.image,songs:[]};for(let e of r.tracklist){let n=[];for(let t of e.track.artists)n.push(t.name);t.songs.push({title:e.track.name,album:e.track.album.name,artists:n})}return JSON.stringify(t)};return t.$set=(t=>{"playlist"in t&&n("playlist",r=t.playlist)}),{playlist:r,downloadCSV:()=>{o(c(),`${r.meta.name}.csv`)},downloadJSON:()=>{l(s(),`${r.meta.name}.json`)}}}class G extends M{constructor(t){super(),J(this,t,F,z,l,["playlist"])}}function W(e){var n;return{c(){(n=u("div")).innerHTML='<h2 class="center-text svelte-15qo6is">Bare with us. We are fetching you playlists.</h2> <div class="spinner-border text-success center svelte-15qo6is" role="status"><span class="sr-only ">Loading...</span></div>',y(n,"class","d-flex justify-content-center svelte-15qo6is")},m(t,e){s(t,n,e)},p:t,i:t,o:t,d(t){t&&i(n)}}}class D extends M{constructor(t){super(),J(this,t,null,W,l,[])}}function I(t,e,n){const r=Object.create(t);return r.element=e[n],r}function K(e){var n,r,o=e.error;return{c(){n=u("p"),r=f(o),y(n,"class","center svelte-3bl96m")},m(t,e){s(t,n,e),c(n,r)},p(t,e){t.playlists&&o!==(o=e.error)&&h(r,o)},i:t,o:t,d(t){t&&i(n)}}}function Q(t){for(var e,n,r=t.array,o=[],a=0;a<r.length;a+=1)o[a]=X(I(t,r,a));const l=t=>U(o[t],1,1,()=>{o[t]=null});return{c(){e=u("div");for(var t=0;t<o.length;t+=1)o[t].c();y(e,"class","card-columns center svelte-3bl96m")},m(t,r){s(t,e,r);for(var a=0;a<o.length;a+=1)o[a].m(e,null);n=!0},p(t,n){if(t.playlists){r=n.array;for(var a=0;a<r.length;a+=1){const l=I(n,r,a);o[a]?(o[a].p(t,l),R(o[a],1)):(o[a]=X(l),o[a].c(),R(o[a],1),o[a].m(e,null))}for(E(),a=r.length;a<o.length;a+=1)l(a);N()}},i(t){if(!n){for(var e=0;e<r.length;e+=1)R(o[e]);n=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)U(o[t]);n=!1},d(t){t&&i(e),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(o,t)}}}function X(t){var e,n=new G({props:{playlist:t.element}});return{c(){n.$$.fragment.c()},m(t,r){T(n,t,r),e=!0},p(t,e){var r={};t.playlists&&(r.playlist=e.element),n.$set(r)},i(t){e||(R(n.$$.fragment,t),e=!0)},o(t){U(n.$$.fragment,t),e=!1},d(t){q(n,t)}}}function Y(e){var n,r=new D({});return{c(){r.$$.fragment.c()},m(t,e){T(r,t,e),n=!0},p:t,i(t){n||(R(r.$$.fragment,t),n=!0)},o(t){U(r.$$.fragment,t),n=!1},d(t){q(r,t)}}}function Z(t){var n,r,o;let a={ctx:t,current:null,token:null,pending:Y,then:Q,catch:K,value:"array",error:"error",blocks:[,,,]};return A(r=t.playlists,a),{c(){n=p(),a.block.c()},m(t,e){s(t,n,e),a.block.m(t,a.anchor=e),a.mount=(()=>n.parentNode),a.anchor=n,o=!0},p(n,o){t=o,a.ctx=t,"playlists"in n&&r!==(r=t.playlists)&&A(r,a)||a.block.p(n,e(e({},t),a.resolved))},i(t){o||(R(a.block),o=!0)},o(t){for(let t=0;t<3;t+=1){U(a.blocks[t])}o=!1},d(t){t&&i(n),a.block.d(t),a.token=null,a=null}}}function tt(t,e,n){let{token:r}=e;let o;return t.$set=(t=>{"token"in t&&n("token",r=t.token)}),t.$$.update=((t={token:1})=>{t.token&&n("playlists",o=(async t=>{let e=await fetch(`/playlists/${t}`,{method:"POST",body:{token:t}}),n=e.json();if(e.ok)return n;throw new Error(res.text())})(r))}),{token:r,playlists:o}}class et extends M{constructor(t){super(),J(this,t,tt,Z,l,["token"])}}function nt(t){var e,n=new et({props:{token:t.token}});return{c(){n.$$.fragment.c()},m(t,r){T(n,t,r),e=!0},p(t,e){var r={};t.token&&(r.token=e.token),n.$set(r)},i(t){e||(R(n.$$.fragment,t),e=!0)},o(t){U(n.$$.fragment,t),e=!1},d(t){q(n,t)}}}function rt(e){var n,r=new P({});return{c(){r.$$.fragment.c()},m(t,e){T(r,t,e),n=!0},p:t,i(t){n||(R(r.$$.fragment,t),n=!0)},o(t){U(r.$$.fragment,t),n=!1},d(t){q(r,t)}}}function ot(t){var e,n,r,o,a=[rt,nt],l=[];function c(t){return t.token?1:0}return e=c(t),n=l[e]=a[e](t),{c(){n.c(),r=p()},m(t,n){l[e].m(t,n),s(t,r,n),o=!0},p(t,o){var s=e;(e=c(o))===s?l[e].p(t,o):(E(),U(l[s],1,1,()=>{l[s]=null}),N(),(n=l[e])||(n=l[e]=a[e](o)).c(),R(n,1),n.m(r.parentNode,r))},i(t){o||(R(n),o=!0)},o(t){U(n),o=!1},d(t){l[e].d(t),t&&i(r)}}}function at(t,e,n){let r,o;return t.$$.update=((t={cookies:1})=>{t.cookies&&n("token",o=r[0].split("=")[1])}),n("cookies",r=document.cookie.split(";")),{token:o}}return new class extends M{constructor(t){super(),J(this,t,at,ot,l,[])}}({target:document.querySelector("#app")})}();
//# sourceMappingURL=bundle.js.map
